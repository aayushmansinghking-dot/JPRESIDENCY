<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>JP Residency Guest Registration and Booking Form</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #2c3e50, #4ca1af);
      color: white;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    h1 {
      background: rgba(0,0,0,0.6);
      padding: 15px;
      margin: 0;
      font-size: 22px;
      font-weight: bold;
    }
    .section {
      display: none;
      padding: 20px;
    }
    .active {
      display: block;
    }
    input, select, textarea, button {
      padding: 8px;
      margin: 6px;
      border-radius: 6px;
      border: none;
    }
    button {
      cursor: pointer;
      background: #27ae60;
      color: white;
      font-weight: bold;
    }
    table {
      margin: 20px auto;
      border-collapse: collapse;
      background: white;
      color: black;
    }
    table, th, td {
      border: 1px solid black;
      padding: 8px 12px;
    }
  </style>
</head>
<body>
  <h1>JP RESIDENCY GUEST REGISTRATION AND BOOKING FORM</h1>

  <!-- First Page -->
  <div id="home" class="section active">
    <button onclick="showSection('registration')">New Registration</button>
    <button onclick="showSection('login')">Already Registered</button>
  </div>

  <!-- Registration Form -->
  <div id="registration" class="section">
    <h2>New Registration</h2>
    <form id="regForm">
      <fieldset>
        <legend>Personal Information</legend>
        <input type="text" name="fullname" placeholder="Full Name" required><br>
        <select name="gender" required>
          <option value="">Select Gender</option>
          <option>Male</option>
          <option>Female</option>
          <option>Other</option>
        </select><br>
        <input type="text" name="phone" placeholder="Phone Number"><br>
        <input type="email" name="email" placeholder="Email ID"><br>
        <textarea name="address" placeholder="Address"></textarea><br>
        <select name="idtype">
          <option>Aadhar Card</option>
          <option>PAN Card</option>
          <option>Passport</option>
          <option>Driving Licence</option>
        </select><br>
        <input type="text" name="idnumber" placeholder="ID Number"><br>
        Upload Aadhar: <input type="file" name="aadhar"><br>
        Upload Signature: <input type="file" name="sign"><br>
      </fieldset>
      <fieldset>
        <legend>Room Details</legend>
        <input type="date" name="dateofliving"><br>
        Guests: 
        <select name="guests">
          <option>1</option><option>2</option><option>3</option><option>4</option>
        </select><br>
      </fieldset>
      <fieldset>
        <legend>Payment Details</legend>
        <input type="text" name="rent" placeholder="Room Rent Per Month"><br>
        <input type="text" name="advance" placeholder="Advance Paid"><br>
        <input type="text" name="electric" placeholder="Previous Electric Meter Reading"><br>
      </fieldset>
      <button type="button" onclick="submitDetails()">Submit Details</button>
    </form>
  </div>

  <!-- Registration Success -->
  <div id="success" class="section"></div>

  <!-- Login Page -->
  <div id="login" class="section">
    <h2>Already Registered</h2>
    <input type="text" id="loginReg" placeholder="Registration Number"><br>
    <input type="password" id="loginPass" placeholder="Password"><br>
    <button onclick="login()">Login</button>
  </div>

  <!-- Details Page -->
  <div id="details" class="section"></div>

<script>
  let registrations = {};
  let currentUser = null;

  function showSection(id) {
    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
  }

  function submitDetails() {
    const form = document.getElementById("regForm");
    const data = Object.fromEntries(new FormData(form).entries());
    const regNo = Math.floor(1000 + Math.random() * 9000);
    data.regNo = regNo;
    data.userPassword = prompt("Create a 4-digit password:");
    registrations[regNo] = data;

    document.getElementById("success").innerHTML = `
      <h2><b>WELCOME MR. ${data.fullname.toUpperCase()} TO JP RESIDENCY</b></h2>
      <p><b>YOUR REGISTRATION NUMBER IS ${regNo}</b></p>
      <p><button onclick="sendDetails('${regNo}')">Send Details to Owner</button></p>
    `;
    showSection("success");
  }

  function sendDetails(regNo) {
    let msg = `JP RESIDENCY NEW GUEST DETAILS%0ARegistration No: ${regNo}`;
    window.open(`https://wa.me/919942823314?text=${msg}`, "_blank");
  }

  function login() {
    const reg = document.getElementById("loginReg").value;
    const pass = document.getElementById("loginPass").value;
    const data = registrations[reg];

    if (!data) {
      alert("Registration not found!");
      return;
    }

    if (pass === data.userPassword) {
      // User Login
      let html = `<h2>Welcome ${data.fullname.toUpperCase()}</h2>
      <p><b>All Your Details</b></p>
      Name: ${data.fullname}<br>
      Phone: ${data.phone}<br>
      Email: ${data.email}<br>
      ID: ${data.idtype} - ${data.idnumber}<br>
      Guests: ${data.guests}<br>
      Rent: ${data.rent}<br>
      Advance: ${data.advance}<br>
      <p><b>Payment Table</b></p>
      <table><tr><th>Month</th><th>Rent</th><th>Status</th></tr>`;
      const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
      months.forEach(m => {
        html += `<tr><td>${m} 2025</td><td>${data.rent}</td><td>Not Done</td></tr>`;
      });
      html += `</table>`;
      document.getElementById("details").innerHTML = html;
      showSection("details");
    } else if (pass === "AMS") {
      // Owner Login
      let html = `<h2>OWNER ACCESS</h2>
      <p>Editing Payments for ${data.fullname.toUpperCase()}</p>
      <table id="payTable"><tr><th>Month</th><th>Rent</th><th>Status</th></tr>`;
      const months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
      months.forEach(m => {
        html += `<tr><td>${m} 2025</td><td>${data.rent}</td>
          <td><select><option>Done</option><option>Not Done</option></select></td></tr>`;
      });
      html += `</table><button onclick="updateChanges('${reg}')">Update Changes</button>`;
      document.getElementById("details").innerHTML = html;
      showSection("details");
    } else {
      alert("Wrong password!");
    }
  }

  function updateChanges(reg) {
    alert("Changes Updated! Visible to User Now.");
    showSection("home");
  }
</script>
</body>
</html>